{% extends "layouts/main.html" %}

{% block header %}
  {% include "includes/header-cw.html"%}
{% endblock %}

{% block pageTitle %}
  {{data['laa-ref'] or "LAA-5a7d3c"}} - Review and adjust quote – {{ serviceName }} – GOV.UK Prototype Kit
{% endblock %}

{% set bodyClasses = 'caseworker-width' %}

{% block beforeContent %}
  {% include "includes/banner.html"%}

   {{ mojPrimaryNavigation({
    label: 'Primary navigation',
    items: [
      {
        text: 'Your applications',
        href: '/caseworker/crm-assess',
        active: false
      },
      {
        text: 'Open applications',
        href: '/caseworker/crm-assess-open',
        active: false
      },
      {
        text: 'Assessed applications',
        href: '/caseworker/crm-assess-closed',
        active: false
      }
    ]
  }) }}
{% endblock %}

{% block content %}

  <div class="govuk-grid-row">
    <div class="govuk-grid-column-two-thirds">
      <span class="govuk-caption-xl">{{data['client-first--name'] or "Roger" }} {{data['client-last--name'] or "Blackbeard" }}</span>
      <h1 class="govuk-heading-xl">{{data['laa-ref'] or "LAA-5a7d3c"}}</h1>
      {% if data['cwAppStatus'] == "New" or data['cwAppStatus'] == null %}
        <strong class="govuk-tag">New</strong>
        {% else %}
        {% if data['cwAppStatus'] == "In progress" %}
          <strong class="govuk-tag">In progress</strong>
          {% else %}
          {% if data['cwAppStatus'] == "Granted" %}
            <strong class="govuk-tag">Granted</strong>
            {% else %}
            {% if data['cwAppStatus'] == "Rejected" %}
              <strong class="govuk-tag">Rejected</strong>
              {% else %}
              {% if data['cwAppStatus'] == "Review" %}
                <strong class="govuk-tag">Provider review</strong>
                {% else %}
                {% if data['cwAppStatus'] == "Appealed" %}
                  <strong class="govuk-tag">Appealed</strong>
                  {% else %}
                  {% if data['cwAppStatus'] == "Amended" %}
                    <strong class="govuk-tag">Amended</strong>
                    {% else %}
                    {% if data['cwAppStatus'] == "Referred" %}
                      <strong class="govuk-tag">Referred</strong>
                    {% endif %}
                  {% endif %}
                {% endif %}
              {% endif %}
            {% endif %}
          {% endif %}
        {% endif %}
      {% endif %}
      <br><br>
      <p><span class="govuk-!-font-size-27">£{{data['actualdistTotalCost'] or "640"}}.00</p>
      <p><span class="govuk-body-l"><strong>Assigned to:</strong> {{data['caseworker1']}}</span>
        <br><span class="govuk-body-l"><strong>Date received:</strong> 17th October 2023</span>
      </p>
    </div>
    <div class="govuk-grid-column-one-third">
      <aside class="app-related-items" role="complementary">
        <ul class="govuk-list govuk-!-font-size-16">
          <li>
            <br>
            <strong>Related applications</strong><br> 
            <a class="govuk-link govuk-link--no-visited-state">{{data['laa-ref'] or "LAA-5a7d3c"}} - John Stevens</a>
          </li>
        </ul>
      </aside>
    </div>
  </div>

  <div class="govuk-grid-row">
    <div class="govuk-grid-column-two-thirds">

       {{ mojSubNavigation({
        label: 'Sub navigation',
        items: [{
          text: 'Application overview',
          href: 'application-details',
          active: false
        }, {
          text: 'Review and adjust',
          href: 'application-details-quote',
          active: true
        }, {
          text: 'Application history',
          href: 'application-details-history'
        }]
      }) }}

      <!--About the request
      <h2 class="govuk-heading-m">About the request</h2>
      -->

      <!--Primary quote
      <div class="govuk-summary-card">
        <div class="govuk-summary-card__title-wrapper">
          <h3 class="govuk-summary-card__title">Primary quote</h3>
        </div>
         <div class="govuk-summary-card__content">
          <dl class="govuk-summary-list govuk-!-margin-bottom-6">
            <div class="govuk-summary-list__row">
              <dt class="govuk-summary-list__key">
                Expert details
              </dt>
              <dd class="govuk-summary-list__value">
                {{data['expert-name'] or "Joanna White" }}<br>
                {{data['expert-org-name'] or "DNA Plc" }}, 
                {{data['expert-postcode'] or "E1 3RD" }}
              </dd>
            </div>
            <div class="govuk-summary-list__row">
              <dt class="govuk-summary-list__key">
                Service required
              </dt>
              <dd class="govuk-summary-list__value">
                 {% if data['serviceType'] == "Other" %}
                  Other: {{data['otherExpert'] or "Driving instructor" }}
                  {% else %}
                  {{data['serviceType'] or "Interpreter"}}
                {% endif %}
              </dd>
            </div>
            <div class="govuk-summary-list__row">
              <dt class="govuk-summary-list__key">
                Quote upload
              </dt>
              <dd class="govuk-summary-list__value">
                <a href="">myquote1.pdf</a>
              </dd>
            </div>
             {% if data['serviceType'] == "Psychiatric report (Prison Law)" or data['serviceType'] == "Psychological report (Prison Law)" or data['serviceType'] == "Interpreter" or  data['serviceType'] == null %}
              <div class="govuk-summary-list__row">
                <dt class="govuk-summary-list__key">
                  Ordered by court
                </dt>
                <dd class="govuk-summary-list__value">
                  {{data['courtOrdered'] or "Yes" }}
                </dd>
              </div>
             {% else %}
             
            {% endif %}
            <div class="govuk-summary-list__row">
              <dt class="govuk-summary-list__key">
                Existing prior authority granted
              </dt>
              <dd class="govuk-summary-list__value">
                {{data['existingAuth'] or "No"}}
              </dd>
            </div>
          </dl>        
        </div>
      </div>
      -->
      <h3 class="govuk-heading-m">{{data['serviceType'] or "Interpreter"}} cost</h3>

      {% if data['serviceAdjust'] == null %}
        {% else %}
        <div class="govuk-inset-text">
          {{data['serviceAdjust']}}
        </div>
      {% endif %}

      {% if data['serviceType'] == "Transcription" %}
        <table class="govuk-table">
          <thead class="govuk-table__head">
            <tr class="govuk-table__row">
              <th scope="col" class="govuk-table__header">Number of minutes</th>
              <th scope="col" class="govuk-table__header">Cost per minute</th>
              <th scope="col" class="govuk-table__header">Provider requested</th>
              <th scope="col" class="govuk-table__header">Caseworker allowed</th>
              <th scope="col" class="govuk-table__header">Action</th>
            </tr>
          </thead>
          <tbody class="govuk-table__body">
            <tr class="govuk-table__row">
              <td class="govuk-table__cell">{{data['transNoMins'] or "20"}} minutes</td>
              <td class="govuk-table__cell">£{{data['transCostMin'] or "20"}} per minute</td>
              <td class="govuk-table__cell">£400.00</td>
              {% if data['actualTransTotal'] == null %}
                <td class="govuk-table__cell"></td>
                {% else %}
                <td class="govuk-table__cell">£{{data['actualTransTotal'] or ""}}.00</td>
              {% endif %}
              <td class="govuk-table__cell"><a href="application-change-quote">Change <span class="govuk-visually-hidden">service costs</span></a></td>
            </tr>
          </tbody>
        </table> 
        {% else %}
        {% if data['serviceType'] == "Translation and transcription" %}
          <table class="govuk-table">
            <thead class="govuk-table__head">
              <tr class="govuk-table__row">
                <th scope="col" class="govuk-table__header">Number of minutes</th>
                <th scope="col" class="govuk-table__header">Cost per minute</th>
                <th scope="col" class="govuk-table__header">Provider requested</th>
                <th scope="col" class="govuk-table__header">Caseworker allowed</th>
                <th scope="col" class="govuk-table__header">Action</th>
              </tr>
            </thead>
            <tbody class="govuk-table__body">
              <tr class="govuk-table__row">
                <td class="govuk-table__cell">{{data['transtransNoMins'] or "20"}} minutes</td>
                <td class="govuk-table__cell">£{{data['transtransCostMin'] or "20"}} per minute</td>
                <td class="govuk-table__cell">£400.00</td>
                {% if data['actualTransTransTotal'] == null %}
                  <td class="govuk-table__cell"></td>
                  {% else %}
                  <td class="govuk-table__cell">£{{data['actualTransTransTotal'] or ""}}.00</td>
                {% endif %}
                <td class="govuk-table__cell"><a href="application-change-quote">Change <span class="govuk-visually-hidden">service costs</span></a></td>
              </tr>
            </tbody>
          </table>
          {% else %}
          {% if data['serviceType'] == "Translator" %} 
            <table class="govuk-table">
              <thead class="govuk-table__head">
                <tr class="govuk-table__row">
                  <th scope="col" class="govuk-table__header">Number of words</th>
                  <th scope="col" class="govuk-table__header">Cost per word</th>
                  <th scope="col" class="govuk-table__header">Provider requested</th>
                  <th scope="col" class="govuk-table__header">Caseworker allowed</th>
                  <th scope="col" class="govuk-table__header">Action</th>
                </tr>
              </thead>
              <tbody class="govuk-table__body">
                <tr class="govuk-table__row">
                  <td class="govuk-table__cell">{{data['translatorWords'] or "20"}} words</td>
                  <td class="govuk-table__cell">£{{data['translatorCostWord'] or "20"}} per word</td>
                  <td class="govuk-table__cell">£400.00</td>
                  {% if data['actualTranslatorTotal'] == null %}
                    <td class="govuk-table__cell"></td>
                    {% else %}
                    <td class="govuk-table__cell">£{{data['actualTranslatorTotal'] or ""}}.00</td>
                  {% endif %}
                  <td class="govuk-table__cell"><a href="application-change-quote">Change <span class="govuk-visually-hidden">service costs</span></a></td>
                </tr>
              </tbody>
            </table>
            {% else %}
            {% if data['serviceType'] == "Photocopying" %} 
              <table class="govuk-table">
                <thead class="govuk-table__head">
                  <tr class="govuk-table__row">
                    <th scope="col" class="govuk-table__header">Number of pages</th>
                    <th scope="col" class="govuk-table__header">Cost per page</th>
                    <th scope="col" class="govuk-table__header">Provider requested</th>
                    <th scope="col" class="govuk-table__header">Caseworker allowed</th>
                    <th scope="col" class="govuk-table__header">Action</th>
                  </tr>
                </thead>
                <tbody class="govuk-table__body">
                  <tr class="govuk-table__row">
                    <td class="govuk-table__cell">{{data['photoNoPages'] or "200"}} pages</td>
                    <td class="govuk-table__cell">£{{data['photoCostPage'] or "2"}} per page</td>
                    <td class="govuk-table__cell">£400.00</td>
                    {% if data['actualPhotoTotal'] == null %}
                      <td class="govuk-table__cell"></td>
                      {% else %}
                      <td class="govuk-table__cell">£{{data['actualPhotoTotal'] or ""}}.00</td>
                    {% endif %}
                    <td class="govuk-table__cell"><a href="application-change-quote?photoNoPages=200&photoCostPage=2&actualPhotoTotal=400">Change <span class="govuk-visually-hidden">service costs</span></a></td>
                  </tr>
                </tbody>
              </table>
              {% else %}
              {% if data['serviceType'] == "Other" and  data['otherChargeType'] =="Charged by the hour"%} 
                <table class="govuk-table">
                  <thead class="govuk-table__head">
                    <tr class="govuk-table__row">
                      <th scope="col" class="govuk-table__header">Time</th>
                      <th scope="col" class="govuk-table__header">Cost per hour</th>
                      <th scope="col" class="govuk-table__header">Provider requested</th>
                      <th scope="col" class="govuk-table__header">Caseworker allowed</th>
                      <th scope="col" class="govuk-table__header">Action</th>
                    </tr>
                  </thead>
                  <tbody class="govuk-table__body">
                    <tr class="govuk-table__row">
                      <td class="govuk-table__cell">{{data['otherNoHours-hours'] or "2"}} hours {{data['otherNoHours-mins'] or "00"}}</td>
                      <td class="govuk-table__cell">£{{data['otherCost'] or "200"}} per hour</td>
                      <td class="govuk-table__cell">£400.00</td>
                      {% if data['actualOtherTotal'] == null %}
                        <td class="govuk-table__cell"></td>
                        {% else %}
                        <td class="govuk-table__cell">£{{data['actualOtherTotal'] or ""}}.00</td>
                      {% endif %}
                      <td class="govuk-table__cell"><a href="application-change-quote?otherChargeType=Charged by the hour">Change <span class="govuk-visually-hidden">service costs</span></a></td>
                    </tr>
                  </tbody>
                </table> 
                {% else %}
                {% if data['serviceType'] == "Other"%} 
                  <table class="govuk-table">
                    <thead class="govuk-table__head">
                      <tr class="govuk-table__row">
                        <th scope="col" class="govuk-table__header">Number of items</th>
                        <th scope="col" class="govuk-table__header">Cost per item</th>
                        <th scope="col" class="govuk-table__header">Provider requested</th>
                        <th scope="col" class="govuk-table__header">Caseworker allowed</th>
                        <th scope="col" class="govuk-table__header">Action</th>
                      </tr>
                    </thead>
                    <tbody class="govuk-table__body">
                      <tr class="govuk-table__row">
                        <td class="govuk-table__cell">{{data['otherNoItems'] or "1"}} items</td>
                        <td class="govuk-table__cell">£{{data['otherItemsCost'] or "400"}} per item</td>
                         <td class="govuk-table__cell">£400.00</td>
                          {% if data['actualOtherTotal'] == null %}
                            <td class="govuk-table__cell"></td>
                            {% else %}
                            <td class="govuk-table__cell">£{{data['actualOtherTotal'] or ""}}.00</td>
                          {% endif %}
                        <td class="govuk-table__cell"><a href="application-change-quote?otherChargeType=Charged per item">Change <span class="govuk-visually-hidden">service costs</span></a></td>
                      </tr>
                    </tbody>
                  </table> 
                  {% else %}
                  {% if data['serviceType'] == "DNA report" %}
                    <!--All other service types-->
                    <table class="govuk-table">
                      <thead class="govuk-table__head">
                        <tr class="govuk-table__row">
                          <th scope="col" class="govuk-table__header">Report cost</th>
                          <th scope="col" class="govuk-table__header">Provider requested</th>
                          <th scope="col" class="govuk-table__header">Caseworker allowed</th>
                          <th scope="col" class="govuk-table__header">Action</th>
                        </tr>
                      </thead>
                      <tbody class="govuk-table__body">
                        <tr class="govuk-table__row">
                          <td class="govuk-table__cell">£{{data['dnaReport'] or "400"}}.00</td>
                          <td class="govuk-table__cell">£400.00</td>
                          {% if data['dnaReprt'] == null %}
                            <td class="govuk-table__cell"></td>
                            {% else %}
                            <td class="govuk-table__cell">£{{data['dnaReprt'] or ""}}.00</td>
                          {% endif %}
                          <td class="govuk-table__cell"><a href="application-change-quote">Change <span class="govuk-visually-hidden">service costs</span></a></td>
                        </tr>
                      </tbody>
                    </table> 
                    {% else %}
                      <!--All other service types-->
                      <table class="govuk-table">
                        <thead class="govuk-table__head">
                          <tr class="govuk-table__row">
                            <th scope="col" class="govuk-table__header">Time</th>
                            <th scope="col" class="govuk-table__header">Cost per hour</th>
                            <th scope="col" class="govuk-table__header">Provider requested</th>
                            <th scope="col" class="govuk-table__header">Caseworker allowed</th>
                            <th scope="col" class="govuk-table__header">Action</th>
                          </tr>
                        </thead>
                        <tbody class="govuk-table__body">
                          <tr class="govuk-table__row">
                            <td class="govuk-table__cell">{{data['generalNoHours-hours'] or "2"}} hours {{data['generalNoHours-mins'] or "00"}} minutes</td>
                            <td class="govuk-table__cell">£{{data['generalCost'] or "200"}} per hour</td>
                            <td class="govuk-table__cell">£400.00</td>
                            {% if data['actualGeneralTotal'] == null %}
                              <td class="govuk-table__cell"></td>
                              {% else %}
                              <td class="govuk-table__cell">£{{data['actualGeneralTotal'] or ""}}.00</td>
                            {% endif %}
                            <td class="govuk-table__cell"><a href="application-change-quote">Change <span class="govuk-visually-hidden">service costs</span></a></td>
                          </tr>
                        </tbody>
                      </table> 
                  {% endif %}
                {% endif %}
              {% endif %}
            {% endif %}
          {% endif %}
        {% endif %}
      {% endif %}

      <h3 class="govuk-heading-m">Travel cost</h3>

      {% if data['addTravel'] =="No" %}
        <p>No travel costs added</p>
        {% else %}

        {% if data['travelAdjust'] == null %}
          {% else %}
          <div class="govuk-inset-text">
            {{data['travelAdjust']}}
          </div>
        {% endif %}

        <p>{{data['whyTravel'] or "The expert lives in Ireland"}}</p>

        <table class="govuk-table">
          <thead class="govuk-table__head">
            <tr class="govuk-table__row">
              <th scope="col" class="govuk-table__header">Travel time</th>
              <th scope="col" class="govuk-table__header">Hourly cost</th>
              <th scope="col" class="govuk-table__header">Provider requested</th>
              <th scope="col" class="govuk-table__header">Caseworker allowed</th>
              <th scope="col" class="govuk-table__header">Action</th>
            </tr>
          </thead>
          <tbody class="govuk-table__body">
            <tr class="govuk-table__row">
              <td class="govuk-table__cell">{{data['travelTime-hours'] or "3"}} hours {{data['travelTime-mins'] or "00"}} minutes</td>
              <td class="govuk-table__cell">£{{data['travelCostTime'] or "40"}}.00 per hour</td>
              <td class="govuk-table__cell">£120.00</td>
              {% if data['actualTravelTotal'] == null %}
                <td class="govuk-table__cell"></td>
                {% else %}
                <td class="govuk-table__cell">£{{data['actualTravelTotal'] or ""}}.00</td>
              {% endif %}
              <td class="govuk-table__cell"><a href="application-change-travel">Change</a></td>
            </tr>
          </tbody>
        </table>
      {% endif %}

      <h3 class="govuk-heading-m">Additional costs</h3>
      {% if data['addAdd'] =="No" %}
        <p>No additional costs added</p>
        {% else %}

        <h4 class="govuk-heading-s">{{data['addCost1'] or "Waiting time"}}</h4>
        {% if data['addCost1Adjust'] == null %}
          {% else %}
          <div class="govuk-inset-text">
            {{data['addCost1Adjust']}}
          </div>
        {% endif %}
        <p>{{data['whyAdd1'] or "Waited at police station for client to be interviewed"}}</p>
        <table class="govuk-table">
          <thead class="govuk-table__head">
            <tr class="govuk-table__row">
              <th scope="col" class="govuk-table__header">Time</th>
              <th scope="col" class="govuk-table__header">Rate per hour</th>
              <th scope="col" class="govuk-table__header">Provider requested</th>
              <th scope="col" class="govuk-table__header">Caseworker allowed</th>
              <th scope="col" class="govuk-table__header">Action</th>
            </tr>
          </thead>
          <tbody class="govuk-table__body">
            <tr class="govuk-table__row">
              <td class="govuk-table__cell">{{data['addTime2-hours'] or "4"}} hours {{data['addTime2-mins'] or "00"}} minutes</td>
              <td class="govuk-table__cell">£{{data['addCostTime2'] or "30"}} per hour</td>
              <td class="govuk-table__cell">£120.00</td>
              {% if data['actualAdd1Total'] == null %}
                <td class="govuk-table__cell"></td>
                {% else %}
                <td class="govuk-table__cell">£{{data['actualAdd1Total'] or ""}}.00</td>
              {% endif %}
              <td class="govuk-table__cell"><a href="application-change-addCost1">Change</a></td>
            </tr>
          </tbody>
        </table>    

        <h4 class="govuk-heading-s">{{data['addCost2'] or "Hotel"}}</h4>
        <p>{{data['whyAdd2'] or "The expert traveled from Ireland and was unable to return the same day."}}</p>

        <table class="govuk-table">
          <thead class="govuk-table__head">
            <tr class="govuk-table__row">
              <th scope="col" class="govuk-table__header">Number of items</th>
              <th scope="col" class="govuk-table__header">Cost per item</th>
              <th scope="col" class="govuk-table__header">Provider requested</th>
              <th scope="col" class="govuk-table__header">Caseworker allowed</th>
              <th scope="col" class="govuk-table__header">Action</th>
            </tr>
          </thead>
          <tbody class="govuk-table__body">
            <tr class="govuk-table__row">
              <td class="govuk-table__cell">{{data['addQuantity2'] or "1"}}</td>
              <td class="govuk-table__cell">£{{data['addNonhourRate2'] or "120"}}.00</td>
              <td class="govuk-table__cell">£120.00</td>
              {% if data['actualAdd2Total'] == null %}
                <td class="govuk-table__cell"></td>
                {% else %}
                <td class="govuk-table__cell">£{{data['actualAdd2Total'] or ""}}.00</td>
              {% endif %}
              <td class="govuk-table__cell"><a href="">Change</a></td>
            </tr>
          </tbody>
        </table>            
      {% endif %}

      <div class="govuk-button-group">
        {{ govukButton({
          text: "Make a decision"
        }) }}

        {{ govukButton({
          text: "Send back to provider",
          classes: "govuk-button--secondary"
        }) }}

        {{ govukButton({
          text: "Request external review ",
          classes: "govuk-button--secondary"
        }) }}

        {{ govukButton({
          text: "Save draft",
          classes: "govuk-button--secondary",
          href: "../crm-assess?cwAppState=all"
        }) }}
      </div>


      

    </div>
  </div>

{% endblock %}