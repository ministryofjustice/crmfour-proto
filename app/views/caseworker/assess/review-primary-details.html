{% extends "layouts/main.html" %}

{% block header %}
  {% include "includes/header-cw.html"%}
{% endblock %}

{% block pageTitle %}
  Review primary quote information – {{ serviceName }} – GOV.UK Prototype Kit
{% endblock %}

{% block beforeContent %}
  {% include "includes/banner.html"%}

  {{ mojPrimaryNavigation({
    label: 'Primary navigation',
    items: [
      {
        text: 'Your applications',
        href: '/caseworker/crm-assess',
        active: false
      },
      {
        text: 'Open applications',
        href: '/caseworker/crm-assess-open',
        active: false
      },
      {
        text: 'Referred applications',
        href: '/caseworker/crm-assess-referred',
        active: false
      },
      {
        text: 'Assessed applications',
        href: '/caseworker/crm-assess-closed',
        active: false
      }
    ]
  }) }}
{% endblock %}

{% block content %}

  <div class="govuk-grid-row">
    <div class="govuk-grid-column-two-thirds">
      <span class="govuk-caption-xl">{{data['laa-ref'] or "LAA-5a7d3c"}}</span>
      <h1 class="govuk-heading-xl">Review primary quote information</h1>

      {% if data['changePrimary'] == "change" %}
        <form class="form" action="check-answers" method="post">
        {% else %}
        <form class="form" action="application-details?reviewPrimary=complete" method="post">
      {% endif %}
      
        <div class="govuk-summary-card">
          <div class="govuk-summary-card__title-wrapper">
            <h3 class="govuk-summary-card__title">Primary quote</h3>
          </div>
          <div class="govuk-summary-card__content">
            <dl class="govuk-summary-list govuk-!-margin-bottom-6">
              <div class="govuk-summary-list__row">
                <dt class="govuk-summary-list__key">
                  Expert details
                </dt>
                <dd class="govuk-summary-list__value">
                  {{data['expert-name'] or "Joanna White" }}<br>
                  {{data['expert-org-name'] or "DNA Plc" }}, 
                  {{data['expert-postcode'] or "E1 3RD" }}
                </dd>
              </div>
              <div class="govuk-summary-list__row">
                <dt class="govuk-summary-list__key">
                  Service required
                </dt>
                <dd class="govuk-summary-list__value">
                  {% if data['serviceType'] == "Other" %}
                    Other: {{data['otherExpert'] or "Driving instructor" }}
                    {% else %}
                    {{data['serviceType'] or "Interpreter"}}
                  {% endif %}
                </dd>
              </div>
              <div class="govuk-summary-list__row">
                <dt class="govuk-summary-list__key">
                  Quote upload
                </dt>
                <dd class="govuk-summary-list__value">
                  <a href="">myquote1.pdf</a>
                </dd>
              </div>
              {% if data['serviceType'] == "Psychiatric report (Prison Law)" or data['serviceType'] == "Psychological report (Prison Law)" or data['serviceType'] == "Interpreter" or  data['serviceType'] == null %}
                <div class="govuk-summary-list__row">
                  <dt class="govuk-summary-list__key">
                    Ordered by court
                  </dt>
                  <dd class="govuk-summary-list__value">
                    {{data['courtOrdered'] or "Yes" }}
                  </dd>
                </div>
              {% else %}
              
              {% endif %}
              <div class="govuk-summary-list__row">
                <dt class="govuk-summary-list__key">
                  Existing prior authority granted
                </dt>
                <dd class="govuk-summary-list__value">
                  {{data['existingAuth'] or "No"}}
                </dd>
              </div>
              {% if data['detained'] == "Yes" or data['prisonLaw'] == "Yes" %}
                {% else %}
                <div class="govuk-summary-list__row">
                  <dt class="govuk-summary-list__key">
                    Why travel costs are required 
                  </dt>
                  <dd class="govuk-summary-list__value">
                    {{data['whyTravel'] or "The expert lives in Ireland"}}
                  </dd>
                </div>
              {% endif %}
            </dl>    

            <p><a href="application-details-adjust">Review and adjust detailed figures</a></p>   
          </div>
        </div>

        {% set fieldHtml %}
          {{ govukTextarea({
            name: "fieldQuote",
            id: "fieldQuote",
            value: data['fieldQuote'],
            label: {
              text: "Caseworker comments"
            },
            hint: {
              text: "Summarise the actions the provider needs to take."
            }
          }) }}    
        {% endset %}

        {% set infoHtml %}
          {{ govukTextarea({
            name: "infoQuote",
            id: "infoQuote",
            value: data['infoQuote'],
            label: {
              text: "Caseworker comments"
            },
            hint: {
              text: "Summarise the actions the provider needs to take."
            }
          }) }}    
        {% endset %}

        {% set docHtml %}
          {{ govukTextarea({
            name: "docQuote",
            id: "docQuote",
            value: data['docQuote'],
            label: {
              text: "Caseworker comments"
            },
            hint: {
              text: "Summarise the actions the provider needs to take."
            }
          }) }}    
        {% endset %}

        {{ govukCheckboxes({
          name: "checkPrimary",
          fieldset: {
            legend: {
              text: "What is the issue?",
              classes: "govuk-fieldset__legend--s"
            }
          },
          hint: {
            text: "Select all that apply."
          },
          items: [
            {
              value: "More information needed",
              text: "More information needed",
              checked: checked("checkPrimary", "More information needed"),
              conditional: {
                html: infoHtml
              }
            },
            {
              value: "Documentation needed",
              text: "Documentation needed",
              checked: checked("checkPrimary", "Documentation needed"),
              conditional: {
                html: docHtml
              }
            }
          ]
        }) }}    
    
        <div class="govuk-button-group">
          {{ govukButton({
            text: "Save comments"
          }) }}

          {% if data['checkPrimary'] == "" or data['checkPrimary'] == null %}
            {% else %}
              {{ govukButton({
                text: "Delete comments",
                classes: "govuk-button--secondary",
                href: "review-primary-details-delete?"
              }) }}
          {% endif %}

          <a class="govuk-link" href="javascript:window.history.back()">Cancel</a>
        </div>

      </form>
    </div>
  </div>

{% endblock %}
